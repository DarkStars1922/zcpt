本项目采用**前后端分离**的分层架构设计，遵循**高内聚、低耦合**原则，按角色权限做精细化控制，将AI审核、文件处理、邮件通知等作为独立支撑组件，兼顾业务落地性和后续扩展

一、整体架构（分层设计）

采用经典的**五层架构**，技术栈选用通用开源方案（降低开发成本，适配竞赛/校园项目场景），各层职责清晰、解耦开发，可独立部署/调试。

|  |  |  |
|----|----|----|
| 层级 | 核心职责 | 推荐开源技术选型 |
| 前端展示层 | 按角色渲染专属界面，处理表单交互、文件上传、数据展示，做前端权限控制 | 前端框架：Vue3；文件上传：WebUploader；路由：Vue Router |
| 网关层（候选） | 统一请求入口，做接口鉴权、请求转发、跨域处理、接口限流 | 鉴权：JWT令牌 |
| 后端服务层 | 处理核心业务逻辑，各模块解耦开发，提供RESTful接口，调用支撑组件完成业务 | 主框架：fastapi |
| 数据持久层 | 负责数据库的增删改查、事务管理、数据分页，做数据校验 | 数据库：MySQL；ORM框架：Pydantic(fastapi) |
| 第三方/支撑层 | 提供AI审核、文件存储、邮件通知、PDF解析等非业务核心的通用能力 | AI OCR：百度OCR/阿里云OCR；文件存储：nginx；邮件；PDF解析：（找轮子） |

**核心架构原则**：

1.  所有角色的**身份认证与权限控制**在网关层+后端服务层双重校验，避免前端越权；

2.  AI审核、邮件通知等作为**独立组件**，通过接口被业务模块调用，后续可单独升级（如替换OCR引擎、优化审核规则）；

3.  所有文件（证明材料、奖状）均**不直接存数据库**，数据库仅存文件存储地址+文件MD5。

二、核心业务模块（按功能+角色划分）

共划分**7个核心业务模块**，覆盖**登录认证、学生申报、AI审核、班委审核、教师管理、系统基础**全流程，所有模块均基于**权限控制模块**做角色拦截，确保不同身份仅能访问对应功能。

模块1：用户认证与权限管理模块

**核心职责**：处理所有用户的登录、身份校验、权限分配，是所有模块的入口前置校验，覆盖3类角色的权限控制。

4.  角色管理：定义**学生/ 班委 / 教师**3类基础角色，配置角色专属接口访问权限；

5.  登录功能：账号密码登录（后续可考虑接入统一认证服务平台），生成带角色标识的JWT令牌；

6.  令牌校验：网关层+接口层双重校验JWT，解析角色信息，拦截无权限/过期请求；

7.  用户信息管理：各角色可修改个人信息，教师可批量查看/导出用户信息。

模块2：学生综测申报管理模块

**核心职责**：支撑学生完成综测材料的**申报、编辑、查看、撤回**全生命周期，是学生角色的核心操作模块。

8.  综测申报表单：提供标准化表单，支持填写**奖项类型、奖项等级、申报简述**，支持**单/多文件上传**（证明材料：PDF/图片，限制文件大小）；

9.  已申报材料管理：展示学生所有申报记录，包含**申报状态（待AI审核/待班委审核/通过/驳回）、申报时间、审核意见**；

10. 材料编辑/撤回：仅对**待审核**状态的申报记录支持编辑（修改信息/重新上传材料）、撤回，已通过/驳回的仅可查看；

11. 申报记录查询：按**申报时间、奖项类型、审核状态**做条件筛选，支持简单的关键词搜索。

模块3：AI审核模块

**核心职责**：作为审核流程的**前置自动化环节**，对学生上传的证明材料做智能校验，输出AI审核结果，供班委审核参考，是衔接学生申报和班委审核的关键。

注：本模块设计为**可配置开关**，若AI审核失败，直接进入**班委人工复核**，避免AI误判导致流程阻塞。

12. 奖状文本识别：调用OCR引擎，对上传的**图片/PDF奖状**做文字提取，识别**奖项名称、颁发单位、获奖时间**，与学生申报表单信息做**一致性校验**；

13. PDF身份校验：解析PDF文件内容/元数据，检查文件中是否包含**申报学生的姓名/学号**，无相关信息则标记为**AI审核异常**（防止代传/错传材料）；

14. AI审核结果生成：对每一份申报材料生成**AI审核报告**（识别内容、校验结果、异常点），将申报记录标记为**AI审核通过/异常**，推送给班委审核模块；

15. 审核日志记录：保存所有AI审核的记录，包含识别内容、校验时间、结果，支持教师/班委查看。

模块4：班委综测审核管理模块

**核心职责**：支撑班委完成**管辖班级**的综测材料审核，结合AI审核报告做人工决策，触发驳回后的邮件通知，是审核流程的核心模块。

16. 审核范围限定：按**班级**绑定审核人，如果没有特殊要求，审核人仅能查看/审核自己管辖班级的学生申报记录；

17. 审核列表展示：展示待审核记录，包含**学生信息、申报表单信息、AI审核报告、证明材料预览**；

18. 审核操作：对单/多记录执行**通过/驳回**操作：

    - 通过：将申报记录状态改为**审核通过**，进入教师查看的最终库；

    - 驳回：需填写**驳回原因**（下拉+选项/自定义文本），提交后自动调用**邮件通知模块**，向学生绑定邮箱发送驳回提醒；

19. 审核记录管理：展示所有审核过的记录，按**审核时间、审核结果、学生姓名**筛选，支持导出审核记录表；

20. 待审核提醒：首页展示**待审核数量**，做红点提醒，避免漏审。

模块5：教师综测管理模块

**核心职责**：支撑教师完成**全局查看、审核人令牌生成、数据统计/导出**，是系统的**管理角色**模块，教师令牌需由内部人员手动生成，审核人令牌由教师自主生成。

21. 全局综测查看：查看**所有学生**的申报记录，包含完整的**AI审核报告、班委审核意见、证明材料**，支持按**年级/班级/奖项类型/审核状态**多条件筛选；

22. 审核人令牌生成：生成**以班级为单位**的审核人身份令牌（加盐，加？），令牌绑定**班级+有效期**，班委需输入令牌完成**审核人身份激活**；

23. 数据统计与导出：按**年级/班级/奖项类型**统计综测申报/通过/驳回数量，生成可视化统计图表，支持导出**全量综测数据表、审核记录表**（Excel/PDF）；

24. 审核异常复核：可对**班委审核结果**做二次复核，支持将“通过”改为“驳回”（触发二次邮件通知），修正班委审核错误；

25. 申报记录归档：对已审核完成（通过/驳回）的记录做批量归档，归档后不可修改，仅可查看。

模块6：令牌管理模块

**核心职责**：专门处理**审核人/教师**的令牌生成、验证、失效，是角色权限的**辅助管理模块**，区分**教师令牌和审核人令牌**。

26. 审核人令牌：支持教师**生成/失效/查询**，令牌与班级绑定，一人可绑定多个班级，令牌激活后生效，过期/失效后审核人失去对应班级审核权限；

27. 教师令牌：由超级管理员通过系统生成，生成后绑定教师工号，令牌为教师登录/权限的最高凭证，支持手动失效；

28. 令牌日志：记录所有令牌的**生成时间、生成人、绑定对象、激活状态、失效时间**，支持追溯。

模块7：系统基础管理模块

**核心职责**：处理系统的**公共配置、日志记录、文件管理**，为所有业务模块提供基础支撑，由教师/内部人员操作。

29. 基础配置：配置综测申报的**奖项类型/等级**、文件上传的**格式/大小限制**、AI审核的**校验规则**、邮件通知的**模板**；

30. 系统日志：记录所有**关键操作**（登录/申报/审核/令牌），包含操作人、操作时间、操作内容、IP地址，支持按条件查询，用于问题追溯；

31. 文件管理：查看/清理系统中的所有上传文件，按**文件类型/上传时间/关联申报记录**筛选，支持手动删除无效文件；

32. 邮件日志：记录所有**驳回提醒邮件**的发送状态、接收人、发送时间、邮件内容，失败的邮件支持手动重发。

模块8：公示及申诉模块（可选）

核心职责：公示学生综测情况，以及供学生进行申诉

33. 由教师选择公示范围和公示信息

34. 学生可选实名申诉和匿名申诉

三、核心支撑组件

本项目的**AI审核、文件存储、邮件通知**是核心非业务能力，设计为**独立支撑组件**，由业务模块通过接口调用，不耦合在业务逻辑中，方便后续替换/升级，以下是3个核心组件的功能说明：

1\. 文件存储组件

35. 核心功能：处理文件上传、预览、下载、删除，支持**图片/PDF**两种核心格式；

36. 存储策略：**本地缓存**，小文件本地缓存，数据库仅存**文件存储地址、文件MD5、文件名称等**；

37. 安全控制：文件预览/下载需校验用户权限（仅申报人/对应审核人/教师可操作），防止文件泄露。

2\. 邮件通知组件

38. 核心功能：仅处理**综测驳回**的邮件提醒，避免无用邮件推送；

39. 模板化配置：提供标准化邮件模板，自动填充**学生姓名、申报记录、驳回原因、修改链接**，支持教师在系统配置模块修改模板内容；

40. 发送策略：采用**异步发送**，发送失败后记录日志，支持手动重发。

3\. 权限控制组件

41. 核心功能：基于角色基础访问控制模型，为所有接口做权限拦截；

42. 细粒度控制：不仅控制**页面访问权限**，还控制**接口操作权限**；

43. 前端权限配合：后端返回当前角色的**可访问菜单/按钮**，前端动态渲染菜单，隐藏无权限按钮，做前端层的权限友好提示。

四、模块间核心交互流程

以**学生申报综测材料**的全流程为例，明确各模块的交互关系，形成业务闭环：

44. 学生通过**用户认证模块**登录，在**学生申报模块**填写表单+上传证明材料，提交申报；

45. 申报记录自动推送给**AI审核模块**，完成OCR识别+PDF身份校验，生成AI审核报告，标记审核状态；

46. **审核人审核模块**拉取管辖班级的待审核记录，班委做**通过/驳回**决策；

    - 驳回：调用**邮件通知组件**，向学生发送驳回邮件，学生在申报模块查看驳回原因并修改；

    - 通过：申报记录进入教师可查看的最终库；

47. 教师通过**教师管理模块**全局查看所有审核完成的记录，可做二次复核、数据统计/导出，也可生成**审核人令牌**为新班委分配审核权限。

五、数据库表设计

按模块设计核心数据库表，做**关联外键**（如申报记录表关联用户表/文件表），满足数据的结构化存储，以下是核心表清单：

|  |  |  |
|----|----|----|
| 表名 | 关联模块 | 核心字段 |
| user_info | 用户认证模块 | 主键ID、学号/工号（唯一）、密码、姓名、角色、班级、邮箱、创建时间 |
| role_permission | 用户认证模块 | 主键ID、角色名称、接口地址、操作权限（查/增/删/改） |
| jwttoken_record | 用户认证模块 | 主键ID、用户ID、JWT令牌、过期时间、登录IP、状态 |
| comprehensive_apply | 学生申报模块 | 主键ID、申报人ID、奖项类型、奖项等级、申报简述、申报时间、审核状态、AI审核报告ID |
| file_info | 学生申报模块/文件组件 | 主键ID、关联申报ID、文件名称、文件地址、文件MD5、文件大小、文件类型、上传时间 |
| ai_audit_report | AI审核模块 | 主键ID、关联申报ID、识别文本、PDF校验结果、AI审核结果、异常点、审核时间 |
| audit_record | 审核人审核模块 | 主键ID、关联申报ID、审核人ID、审核结果、驳回原因、审核时间 |
| token_info | 令牌管理模块 | 主键ID、令牌内容、绑定对象（用户ID/班级）、令牌类型（教师/审核人）、有效期、激活状态 |
| email_record | 邮件通知组件 | 主键ID、接收人邮箱、关联申报ID、驳回原因、邮件内容、发送状态、发送时间 |
| system_log | 系统基础模块 | 主键ID、操作人ID、操作内容、操作接口、IP地址、操作时间 |
| system_config | 系统基础模块 | 主键ID、配置项名称（如奖项类型/邮件模板）、配置项值、修改时间、修改人ID |
